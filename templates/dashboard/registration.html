
{% extends 'dashboard/layouts/base.html' %}

{% load static %}
{% block content %}
<main class="ttr-wrapper">
		<div class="container-fluid">
			<div class="db-breadcrumb">
				<h4 class="breadcrumb-title">Registration</h4>
				<ul class="db-breadcrumb-list">
					<li><a href="{% url 'dashboard' %}"><i class="fa fa-tv"></i>Dashboard</a></li>
					<li>Zephyrus</li>
                    <li>Registration</li>
				</ul>
			</div>
			<div class="row">
				<div class="col-lg-12 m-b30">
					<div class="widget-box">
						<div class="wc-title">
							<h4>Event Registration</h4>
						</div>
						<div class="widget-inner">
                            <div class="row">
                                <div class="col-lg-5">
                                    <div class="card mb-2">
                                        <div class="card-header">
                                            <div class="form-check">
                                            <b>Events</b>
                                              <span style="float:right;">
                                                 <b> Reg fee</b>
                                              </span>
                                            </div>
                                        </div>
                                    </div>
                                    {% for event in events %}
                                    <div class="card mt-1">
                                        <div class="card-body">
                                            <div class="form-check">
                                              <input class="form-check-input selectEvent" type="checkbox" value="{{ event.name }}" event_id="{{ event.id }}" price="{{ event.reg_fee }}">
                                              <label class="form-check-label" for="flexCheckDefault">
                                                <b>{{ event.name }}</b>
                                              </label>
                                              <span style="float:right;">
                                                  Rs.{{ event.reg_fee }}
                                              </span>
                                            </div>
                                        </div>
                                    </div>
                                    {% endfor %}
                                </div>
                                <div class="col-lg-2"></div>
                                <div class="col-lg-5">
                                    <div class="card">
                                        <div class="card-header">
                                            Cost Summary
                                        </div>
                                        <div class="card-body">
                                        <table class="table border-top-0 border-white">
                                          <thead>
                                            <tr>
                                              <th scope="col" class="border-bottom-0 border-white">Event Name</th>
                                              <th scope="col" class="border-bottom-0 border-white">Fee</th>
                                            </tr>
                                          </thead>
                                          <tbody id="costSummary">

                                          </tbody>
                                        </table>
                                            <hr>
                                            <h5>Total: Rs. <span id="totalPrice"></span></h5>
                                        </div>
                                        <div class="card-footer bg-transparent">
                                            <button class="btn btn-primary">Make Payment</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</main>

{% endblock content %}

{% block scripts %}
<script>
class CustomSelect {
  constructor(originalSelect) {
    this.originalSelect = originalSelect;
    this.customSelect = document.createElement("div");
    this.customSelect.classList.add("select");

    this.originalSelect.querySelectorAll("option").forEach((optionElement) => {
      const itemElement = document.createElement("div");

      itemElement.classList.add("select__item");
      itemElement.textContent = optionElement.textContent;
      this.customSelect.appendChild(itemElement);

      if (optionElement.selected) {
        this._select(itemElement);
      }

      itemElement.addEventListener("click", () => {
        if (
          this.originalSelect.multiple &&
          itemElement.classList.contains("select__item--selected")
        ) {
          this._deselect(itemElement);
        } else {
          this._select(itemElement);
        }
      });
    });

    this.originalSelect.insertAdjacentElement("afterend", this.customSelect);
    this.originalSelect.style.display = "none";
  }

  _select(itemElement) {
    const index = Array.from(this.customSelect.children).indexOf(itemElement);

    if (!this.originalSelect.multiple) {
      this.customSelect.querySelectorAll(".select__item").forEach((el) => {
        el.classList.remove("select__item--selected");
      });
    }

    this.originalSelect.querySelectorAll("option")[index].selected = true;
    itemElement.classList.add("select__item--selected");
  }

  _deselect(itemElement) {
    const index = Array.from(this.customSelect.children).indexOf(itemElement);

    this.originalSelect.querySelectorAll("option")[index].selected = false;
    itemElement.classList.remove("select__item--selected");
  }
}

document.querySelectorAll(".custom-select").forEach((selectElement) => {
  new CustomSelect(selectElement);
});

</script>
{% endblock scripts %}