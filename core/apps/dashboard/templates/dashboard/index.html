{% extends 'dashboard/layouts/base.html' %}

{% load static %}
{% block content %}
	<main class="ttr-wrapper">
		<div class="container-fluid">
			<div class="db-breadcrumb">
				<h4 class="breadcrumb-title">Dashboard</h4>
				<ul class="db-breadcrumb-list">
					<li>Dashboard</li>
				</ul>
			</div>
			<div class="row">
				<div class="col-lg-8 mb-3">
					<div class="widget-box mb-3">
						<div class="wc-title">
							<h4>Your Dashboard</h4>
						</div>
						<div class="widget-inner">
                            <div id="carouselExampleIndicators" class="carousel slide" data-bs-ride="carousel">
                              <div class="carousel-indicators">
                                {% for slide in slideshow %}
                                <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="{{ slide.order }}" {% if slide.order == 0 %}class="active" aria-current="true"{% endif %} aria-label="Slide"></button>
                                {% endfor %}
                              </div>
                              <div class="carousel-inner">
                                  {% for slide in slideshow %}
                                    <div class="carousel-item {% if slide.order == 0 %}active{% endif %}">
                                      <img src="{{ slide.image }}" class="d-block w-100" alt="...">
                                    </div>
                                  {% endfor %}
                              </div>
                              <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide="prev">
                                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                                <span class="visually-hidden">Previous</span>
                              </button>
                              <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide="next">
                                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                                <span class="visually-hidden">Next</span>
                              </button>
                            </div>
						</div>
					</div>
				</div>

				<div class="col-lg-4 m-b30">
                    {% if request.user.student.active_registrations %}
                        <div class="card">
                            <div class="card-header text-center bg-transparent">
                               <b> Active Registrations</b>
                            </div>
                        <ul class="nav nav-tabs mb-3 ml-1 p-0" id="pills-tab" role="tablist">
                        {% for registration in request.user.student.active_registrations %}
                              <li class="nav-item" role="presentation">
                                <button class="nav-link {% if forloop.first %}active{% endif %}" id="pills-home-tab" data-bs-toggle="pill" data-bs-target="#pills-home{{ registration.id }}" type="button" role="tab" aria-controls="pills-home" aria-selected="true">{{ registration.event.name }}</button>
                              </li>
                        {% endfor %}
                        </ul>
                        <div class="tab-content" id="pills-tabContent">
                        {% for registration in request.user.student.active_registrations %}
                            <div class="tab-pane fade show {% if forloop.first %}active{% endif %}" id="pills-home{{ registration.id }}" role="tabpanel" aria-labelledby="pills-home-tab">
                                <div class="card-body p-3 text-center bg-transparent">
                                    <div class=" image d-flex flex-column justify-content-center align-items-center"> <button class="btn-sm btn-outline-dark"> <img src="{% if request.user.student.registration.qr %}{{ request.user.student.registration.qr }}{% else %}https://cdn.discordapp.com/attachments/835918464915996705/924684871442518136/qrcode.png{% endif%}" height="100" width="100" /></button> <span class="name mt-3">{{ request.user.student.name }}</span> <span class="idd">{{ request.user.student.college_name }}</span>
                                        <div class="d-flex flex-row justify-content-center align-items-center gap-2 mt-2"><button class="btn-sm btn-outline-light mt-2 w-100 text-dark border-0" style="background-color: lightsteelblue"><b>{{ registration.id }}</b></button></div>
                                    </div>

                                    <a href="{% url 'my_registration_details' event_link=registration.event.link %}" class="btn btn-sm btn-dark mt-3"><i class="bi bi-exclamation-circle-fill"></i> Registration Details</a>

                                  <div class="card-footer bg-transparent mt-5">
                                      <a class="btn btn-sm text-white w-100" style="background-color: #6021ff" href="{% url 'programs' event_link=registration.event.link %}"><i class="bi bi-calendar2-check"></i> Event Details</a>
                                      <a class="btn btn-sm btn-dark w-100 mt-2" href="{% url 'schedule' event_link=registration.event.link %}"><i class="bi bi-alarm"></i> Your Schedule</a>
                                      <a class="btn btn-sm btn-warning w-100 mt-2" href="{% url 'registration' event_link=registration.event.link %}"><i class="bi bi-calendar-plus"></i> Register Now</a>
                                  </div>
                                </div>
                            </div>
                        {% endfor %}
                        </div>
                        </div>
                    {% else %}
                    <div class="card d-md-none d-lg-none d-sm-block">
                      <div class="card-footer bg-light">
                        <ul class="nav nav-tabs mb-3 ml-1 p-0" id="pills-tab" role="tablist">
                        {% for event in request.user.student.active_events %}
                              <li class="nav-item" role="presentation">
                                <button class="nav-link {% if forloop.first %}active{% endif %}" id="pills-home-tab" data-bs-toggle="pill" data-bs-target="#pills-tabs-{{ event.link }}" type="button" role="tab" aria-controls="pills-home" aria-selected="true">{{ event.name }}</button>
                              </li>
                        {% endfor %}
                        </ul>
                        <div class="tab-content" id="pills-tabs-tabContent">
                        {% for event in request.user.student.active_events %}
                            <div class="tab-pane fade show {% if forloop.first %}active{% endif %}" id="pills-tabs-{{ event.link }}" role="tabpanel" aria-labelledby="pills-home-tab">
                              <a class="btn btn-sm w-100 text-white" style="background-color: #6021ff" href="{% url 'programs' event_link=event.link %}"><i class="bi bi-calendar2-check"></i> Event Details</a>
                              <a class="btn btn-sm text-white w-100 mt-2" style="background-color: #0a0023" href="{% url 'schedule' event_link=event.link %}"><i class="bi bi-alarm"></i> Event Schedule</a>
                              <a class="btn btn-sm w-100 mt-2" style="background-color: #ecc731" href="{% url 'registration' event_link=event.link %}"><i class="bi bi-calendar-plus"></i> Register Now</a>
                            </div>
                        {% endfor %}
                        </div>
                      </div>
                    </div>
                    <div class="card bg-white">
                      <div class="card-header text-dark text-center bg-transparent">
                        <b>Zephyrus Registration Demo</b>
                      </div>
                      <div class="card-body bg-transparent">
                        <iframe width="100%" height="315"
                        src="https://www.youtube.com/embed/zuOUN-VSI40">
                        </iframe>
                      </div>
                    </div>
                    {% endif %}
				</div>
			</div>
		</div>
	</main>
{% endblock content %}
